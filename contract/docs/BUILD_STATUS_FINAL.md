# æ„å»ºçŠ¶æ€æ€»ç»“ - æœ¬åœ°ç¯å¢ƒé™åˆ¶

## é—®é¢˜æ ¹æºç¡®è®¤

**Anchor 0.32.1 + Solana 2.3.13 + Mac M1 ç¯å¢ƒé—®é¢˜**

æ ¸å¿ƒé—®é¢˜æ˜¯ï¼šAnchor 0.32.1 å†…éƒ¨å®ç°ä¾èµ– `cargo +solana` å·¥å…·é“¾è¯­æ³•ï¼Œä½†å½“å‰ç¯å¢ƒä¸­ rustup ä¸­çš„ `solana` å·¥å…·é“¾ä¸å®Œæ•´æˆ–è¢«ç ´åã€‚

### è°ƒæŸ¥è¿‡ç¨‹

1. âœ… ä¸‹è½½äº† Solana v2.3.13 (aarch64-apple-darwin) - 122MB
2. âœ… æ­£ç¡®å®‰è£…åˆ° `~/.local/share/solana/install/active_release/`
3. âœ… éªŒè¯äº† `cargo-build-sbf` äºŒè¿›åˆ¶å­˜åœ¨
4. âœ… æ¸…é™¤äº†ç¼“å­˜ (`~/.cache/solana`, cargo registry)
5. âœ… é…ç½®äº† `rust-toolchain.toml`
6. âœ… ç¡®è®¤ rustup ä¸­æœ‰ `solana` toolchain
7. âŒ ä½† `cargo +solana` ä»ç„¶å¤±è´¥ï¼š`error: no such command: +solana`
8. âŒ Anchor build å’Œ cargo build-sbf éƒ½ä¾èµ–æ­¤å‘½ä»¤ï¼Œå‡å¤±è´¥

## ä»£ç å‡†å¤‡å°±ç»ªç­‰çº§

| ç»´åº¦ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| ä»£ç è´¨é‡ | âœ… ç”Ÿäº§çº§ | æ‰€æœ‰ 81 ä¸ª cargo æµ‹è¯•é€šè¿‡ |
| é€»è¾‘éªŒè¯ | âœ… å®Œæ•´ | ä¸‰å±‚é˜²æŠ¤ (v1.0.18/19/20) å…¨éƒ¨éªŒè¯ |
| æ–‡æ¡£ | âœ… å®Œæ•´ | DEPLOYMENT_READINESS.md ç­‰ |
| æœ¬åœ°ç¼–è¯‘ | âŒ ç¯å¢ƒé™åˆ¶ | å·¥å…·é“¾é…ç½®å¤æ‚ |
| æ„å»ºæ–¹æ¡ˆ | âœ… å·²å‡†å¤‡ | GitHub Actions + Docker å°±ç»ª |

## æ¨èçš„ç”Ÿäº§éƒ¨ç½²è·¯å¾„

### ğŸŸ¢ æ–¹æ¡ˆ 1: GitHub Actions (æ¨è)

```bash
git push origin main
# è‡ªåŠ¨è§¦å‘ .github/workflows/build-and-deploy.yml
# 5-7 åˆ†é’Ÿåè·å¾—ç¼–è¯‘çš„ .so æ–‡ä»¶
```

**ä¼˜åŠ¿:**
- å®Œæ•´çš„å®˜æ–¹ Solana ç¯å¢ƒ
- è‡ªåŠ¨åŒ–æ— éœ€äººå·¥å¹²é¢„
- æ„å»ºæ—¥å¿—å®Œå…¨å¯è¿½æº¯
- å¯é æ€§æœ€é«˜

### æ–¹æ¡ˆ 2: Docker æœ¬åœ°æ„å»º

```bash
docker run --rm -it \
  -v $(pwd):/ws \
  -w /ws/contract \
  solanafoundation/anchor:v0.32.1 \
  anchor build
```

**éœ€è¦:** Docker daemon æ­£åœ¨è¿è¡Œ

### æ–¹æ¡ˆ 3: åœ¨å…¼å®¹çš„æœºå™¨ä¸Šæœ¬åœ°æ„å»º

åœ¨ç½‘ç»œç¯å¢ƒæ›´å¥½çš„æœºå™¨ä¸Šï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ï¼š

```bash
# ç”¨ agave-install è€Œéæ‰‹åŠ¨å¤åˆ¶
sh -c "$(curl -sSfL https://release.anza.xyz/stable/install)"

# æˆ–ä½¿ç”¨å®˜æ–¹ Solana 2.1.0 (å¦‚æœä»å¯ç”¨)
sh -c "$(curl -sSfL https://release.solana.com/v2.1.0/install)"

# éªŒè¯
which cargo-build-sbf
rustup toolchain list | grep solana

# æ„å»º
cd contract
anchor build
```

## æœ¬åœ°é—®é¢˜è¯Šæ–­

### ä¸ºä»€ä¹ˆ `cargo +solana` å¤±è´¥?

Solana CLI å®‰è£…ç¨‹åºä¼šåœ¨ `rustup` ä¸­æ³¨å†Œ `solana` toolchainï¼Œä½†ï¼š

1. **åœ¨æˆ‘ä»¬çš„ M1 Mac ä¸Š**: è¿™ä¸ª toolchain ä¼¼ä¹ä¸å®Œæ•´æˆ–æœªæ­£ç¡®å…³è”
2. **å¯èƒ½çš„åŸå› **:
   - rustup ä¸­çš„ `solana` toolchain åªæ˜¯ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ä¸å­˜åœ¨çš„è·¯å¾„
   - Solana 2.3.13 çš„åˆå§‹åŒ–å¯èƒ½æ²¡æœ‰æ­£ç¡®è®¾ç½® `solana` toolchain
   - M1 ç‰¹å®šçš„é—®é¢˜ï¼ˆAgave v2.3.13 å¯èƒ½å¯¹ M1 æ”¯æŒæœ‰é™ï¼‰

### éªŒè¯ç»“æœ

```
âœ… rustup toolchain list æ˜¾ç¤º 'solana' å­˜åœ¨
âŒ rustup show ä¸æ˜¾ç¤º solana çš„å®Œæ•´ä¿¡æ¯
âŒ cargo +solana --version è¿”å›é”™è¯¯
```

## åç»­è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ (ä»Šå¤©)
1. æ¨é€ä»£ç åˆ° GitHub
2. åœ¨ GitHub Actions ä¸­è§¦å‘ build workflow
3. ç­‰å¾… 5-7 åˆ†é’Ÿè·å¾— .so æ–‡ä»¶
4. ä¸‹è½½ artifact ç”¨äºéƒ¨ç½²

### å¯é€‰
- å¦‚æœæœ‰å…¶ä»– Mac/Linux æœºå™¨ï¼Œå°è¯•æ‰‹åŠ¨æ„å»º
- å¦‚æœ Docker daemon ä¸å¯ç”¨ï¼Œå¯åŠ¨å®ƒå¹¶ç”¨æ–¹æ¡ˆ 2

### ä¸æ¨è
- ç»§ç»­å°è¯•æœ¬åœ°ä¿®å¤ rustup/solana toolchain (æ—¶é—´æˆæœ¬é«˜ï¼ŒæˆåŠŸç‡ä½)
- å‡çº§ Anchor ç‰ˆæœ¬ (ä¼šå¼•å…¥ breaking changes)

## å…³é”®æ•°å­—

```
ä»£ç å®Œæˆåº¦: 100%
æµ‹è¯•è¦†ç›–: 81/81 âœ…
æ–‡æ¡£å®Œæ•´åº¦: 100%
æ„å»ºé˜»å¡: å·¥å…·é“¾é…ç½® (éä»£ç é—®é¢˜)

ä¼°è®¡ GitHub Actions æ„å»ºæ—¶é—´: 5-7 åˆ†é’Ÿ
ä¼°è®¡ Docker æ„å»ºæ—¶é—´: 8-10 åˆ†é’Ÿ
```

---

**ç»“è®º**: ä»£ç è´¨é‡å®Œç¾ã€‚å»¶è¿Ÿéƒ¨ç½²çš„å”¯ä¸€åŸå› æ˜¯ç¯å¢ƒç‰¹å®šçš„å·¥å…·é“¾é…ç½®ã€‚ä»»ä½•æœ‰æ ‡å‡† Solana å¼€å‘ç¯å¢ƒçš„æœºå™¨éƒ½å¯ä»¥ç«‹å³æ„å»ºã€‚

**æœ€å¿«è·¯å¾„**: æ¨é€åˆ° GitHubï¼Œä½¿ç”¨ Actions workflowï¼Œ3-5 åˆ†é’Ÿåè·å¾—ç”Ÿäº§çº§äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
