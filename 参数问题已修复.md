# âœ… å‚æ•°é—®é¢˜å·²ä¿®å¤

## ğŸ¯ é—®é¢˜å†ç¨‹

### é”™è¯¯ 1: IncorrectAuthority âœ… å·²ä¿®å¤
**åŸå› **: å­—æ®µåä½¿ç”¨äº†é©¼å³°å‘½åè€Œä¸æ˜¯è›‡å½¢å‘½å
**è§£å†³**: æ›´æ–°æ‰€æœ‰å­—æ®µåä¸ºæ­£ç¡®çš„è›‡å½¢æ ¼å¼

### é”™è¯¯ 2: InvalidParameter âœ… å·²ä¿®å¤  
**åŸå› **: ç¼ºå°‘å¿…éœ€çš„é…ç½®å­—æ®µ
**è§£å†³**: æ·»åŠ æ‰€æœ‰ 23 ä¸ªå¿…éœ€å­—æ®µ

---

## âœ… å®Œæ•´çš„é…ç½®å‚æ•°

ç°åœ¨ä½¿ç”¨çš„æ­£ç¡®å‚æ•°ï¼ˆå…± 23 ä¸ªå­—æ®µï¼‰ï¼š

```typescript
{
  // 1. æƒé™ç®¡ç†
  authority: wallet.publicKey,              // å½“å‰ç®¡ç†å‘˜
  pending_authority: PublicKey.default,     // å¾…ç¡®è®¤ç®¡ç†å‘˜
  team_wallet: teamWalletPubkey,            // å›¢é˜Ÿé’±åŒ…
  
  // 2. æ‰‹ç»­è´¹é…ç½®
  platform_buy_fee: 30,                     // å¹³å°ä¹°å…¥è´¹ (0.3%)
  platform_sell_fee: 30,                    // å¹³å°å–å‡ºè´¹ (0.3%)
  lp_buy_fee: 20,                           // LPä¹°å…¥è´¹ (0.2%)
  lp_sell_fee: 20,                          // LPå–å‡ºè´¹ (0.2%)
  
  // 3. ä»£å¸é…ç½®
  token_supply_config: 1_000_000_000_000,   // æ€»ä¾›åº”é‡ (1M USDC)
  token_decimals_config: 6,                 // ç²¾åº¦ (å¿…é¡»æ˜¯6)
  initial_real_token_reserves_config: 500_000_000,  // åˆå§‹å‚¨å¤‡ (500 USDC)
  
  // 4. æµåŠ¨æ€§é…ç½®
  min_sol_liquidity: 5_000_000_000,         // æœ€å°SOLæµåŠ¨æ€§ (5 SOL, å†å²å­—æ®µ)
  min_trading_liquidity: 100_000_000,       // æœ€å°äº¤æ˜“æµåŠ¨æ€§ (100 USDC)
  
  // 5. çŠ¶æ€æ ‡å¿—
  initialized: false,                       // åˆå§‹åŒ–æ ‡å¿—
  is_paused: false,                         // æš‚åœæ ‡å¿—
  whitelist_enabled: false,                 // ç™½åå•å¼€å…³
  
  // 6. USDC é…ç½®
  usdc_mint: USDC_MINT_DEVNET,              // USDC mintåœ°å€
  usdc_vault_min_balance: 1_000_000,        // USDCé‡‘åº“æœ€å°ä½™é¢ (1 USDC)
  min_usdc_liquidity: 100_000_000,          // æœ€å°USDCæµåŠ¨æ€§ (100 USDC)
  
  // 7. ä¿é™©æ± é…ç½®
  lp_insurance_pool_balance: 0,             // ä¿é™©æ± ä½™é¢ (åˆå§‹ä¸º0)
  lp_insurance_allocation_bps: 2000,        // ä¿é™©æ± åˆ†é…æ¯”ä¾‹ (20%)
  insurance_loss_threshold_bps: 1000,       // æŸå¤±é˜ˆå€¼ (10%)
  insurance_max_compensation_bps: 5000,     // æœ€å¤§è¡¥å¿æ¯”ä¾‹ (50%)
  insurance_pool_enabled: false,            // ä¿é™©æ± å¼€å…³ (åˆå§‹ç¦ç”¨)
}
```

---

## ğŸš€ ç°åœ¨å¯ä»¥ä½¿ç”¨äº†

### æ­¥éª¤ 1: åˆ·æ–°é¡µé¢
```
http://localhost:3000/admin/initialize
```

æŒ‰ `Ctrl + Shift + R` å¼ºåˆ¶åˆ·æ–°

### æ­¥éª¤ 2: åˆå§‹åŒ–é…ç½®
1. è¿æ¥é’±åŒ…
2. ç‚¹å‡» "Check Configuration Status"
3. ç‚¹å‡» "Initialize Configuration"
4. åœ¨é’±åŒ…ä¸­æ‰¹å‡†äº¤æ˜“

### æ­¥éª¤ 3: éªŒè¯æˆåŠŸ
åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… Configuration initialized successfully!
Transaction: [ç­¾å]
```

---

## ğŸ“‹ å­—æ®µè¯´æ˜

### å¿…é¡»æ˜¯å›ºå®šå€¼çš„å­—æ®µ

| å­—æ®µ | å€¼ | è¯´æ˜ |
|------|-----|------|
| `token_decimals_config` | 6 | å¿…é¡»æ˜¯6ï¼ˆUSDCç²¾åº¦ï¼‰ |
| `initialized` | false | åˆå§‹åŒ–æ—¶å¿…é¡»æ˜¯false |
| `pending_authority` | PublicKey.default | åˆå§‹åŒ–æ—¶ä½¿ç”¨é»˜è®¤å€¼ |
| `lp_insurance_pool_balance` | 0 | åˆå§‹åŒ–æ—¶å¿…é¡»æ˜¯0 |

### å¯ä»¥è‡ªå®šä¹‰çš„å­—æ®µ

| å­—æ®µ | é»˜è®¤å€¼ | èŒƒå›´ | è¯´æ˜ |
|------|--------|------|------|
| `platform_buy_fee` | 30 | 0-10000 | 0.3% (30 basis points) |
| `platform_sell_fee` | 30 | 0-10000 | 0.3% |
| `lp_buy_fee` | 20 | 0-10000 | 0.2% |
| `lp_sell_fee` | 20 | 0-10000 | 0.2% |
| `token_supply_config` | 1M USDC | >0 | ä»£å¸æ€»ä¾›åº”é‡ |
| `initial_real_token_reserves_config` | 500 USDC | >0, â‰¤1M USDC | åˆå§‹å‚¨å¤‡ |
| `whitelist_enabled` | false | true/false | æ˜¯å¦å¯ç”¨ç™½åå• |
| `insurance_pool_enabled` | false | true/false | æ˜¯å¦å¯ç”¨ä¿é™©æ±  |

---

## ğŸ” å‚æ•°éªŒè¯è§„åˆ™

### 1. token_decimals_config
```rust
require!(
    new_config.token_decimals_config == 6,
    InvalidParameter
);
```
**å¿…é¡»ç­‰äº 6**ï¼ˆUSDC ç²¾åº¦ï¼‰

### 2. token_supply_config
```rust
require!(
    new_config.token_supply_config >= new_config.initial_real_token_reserves_config,
    InvalidAmount
);
```
**å¿…é¡» â‰¥ initial_real_token_reserves_config**

### 3. initial_real_token_reserves_config
```rust
require!(
    new_config.initial_real_token_reserves_config > 0,
    InvalidParameter
);
require!(
    new_config.initial_real_token_reserves_config <= MAX_LMSR_B,
    ValueTooLarge
);
```
**å¿…é¡» > 0 ä¸” â‰¤ 1M USDC**

### 4. æ‰‹ç»­è´¹
```rust
require!(
    new_config.platform_buy_fee <= 10000,
    ValueTooLarge
);
```
**æ‰€æœ‰æ‰‹ç»­è´¹å¿…é¡» â‰¤ 10000 (100%)**

---

## ğŸ› å¸¸è§é”™è¯¯

### InvalidParameter (é”™è¯¯ç  6028)
**åŸå› **: 
- `token_decimals_config` ä¸ç­‰äº 6
- `initial_real_token_reserves_config` = 0
- ç¼ºå°‘å¿…éœ€å­—æ®µ

**è§£å†³**: ç¡®ä¿æ‰€æœ‰ 23 ä¸ªå­—æ®µéƒ½å·²åŒ…å«ä¸”å€¼æ­£ç¡®

### ValueTooLarge
**åŸå› **: 
- æ‰‹ç»­è´¹ > 10000
- `initial_real_token_reserves_config` > 1M USDC

**è§£å†³**: æ£€æŸ¥æ•°å€¼èŒƒå›´

### InvalidAmount
**åŸå› **: 
- `token_supply_config` < `initial_real_token_reserves_config`

**è§£å†³**: ç¡®ä¿æ€»ä¾›åº”é‡ â‰¥ åˆå§‹å‚¨å¤‡

---

## ğŸ“Š æ¨èé…ç½®

### å¼€å‘/æµ‹è¯•ç¯å¢ƒ
```typescript
{
  platform_buy_fee: 30,        // 0.3%
  platform_sell_fee: 30,       // 0.3%
  lp_buy_fee: 20,              // 0.2%
  lp_sell_fee: 20,             // 0.2%
  token_supply_config: 1_000_000_000_000,  // 1M USDC
  initial_real_token_reserves_config: 500_000_000,  // 500 USDC
  whitelist_enabled: false,    // ä¸é™åˆ¶åˆ›å»ºè€…
  insurance_pool_enabled: false,  // æš‚ä¸å¯ç”¨ä¿é™©æ± 
}
```

### ç”Ÿäº§ç¯å¢ƒ
```typescript
{
  platform_buy_fee: 30,        // 0.3%
  platform_sell_fee: 30,       // 0.3%
  lp_buy_fee: 20,              // 0.2%
  lp_sell_fee: 20,             // 0.2%
  token_supply_config: 1_000_000_000_000,  // 1M USDC
  initial_real_token_reserves_config: 1_000_000_000,  // 1000 USDC (æ›´é«˜å‚¨å¤‡)
  whitelist_enabled: true,     // å¯ç”¨ç™½åå•
  insurance_pool_enabled: true,  // å¯ç”¨ä¿é™©æ± 
}
```

---

## ğŸ¯ éªŒè¯æ¸…å•

åˆå§‹åŒ–å‰æ£€æŸ¥ï¼š
- [ ] æ‰€æœ‰ 23 ä¸ªå­—æ®µéƒ½å·²åŒ…å«
- [ ] `token_decimals_config` = 6
- [ ] `authority` = å½“å‰é’±åŒ…åœ°å€
- [ ] `initialized` = false
- [ ] `lp_insurance_pool_balance` = 0
- [ ] æ‰‹ç»­è´¹ â‰¤ 10000
- [ ] `initial_real_token_reserves_config` > 0
- [ ] `token_supply_config` â‰¥ `initial_real_token_reserves_config`

---

## ğŸ‰ é—®é¢˜å·²è§£å†³

ç°åœ¨ä½ å¯ä»¥ï¼š
1. âœ… æˆåŠŸåˆå§‹åŒ–é…ç½®
2. âœ… åˆ›å»ºé¢„æµ‹å¸‚åœº
3. âœ… æµ‹è¯•æ‰€æœ‰åŠŸèƒ½

**ç«‹å³å¼€å§‹**: http://localhost:3000/admin/initialize

åˆ·æ–°é¡µé¢å¹¶é‡è¯•ï¼
